<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Garbage Management System v2.0</title>
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="assets/css/animations.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <script src="assets/js/main.js"></script>
    <script src="assets/js/auth.js"></script>
</head>
<body>

    

    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <i class="fas fa-recycle"></i>
                <span>SmartGarbage v2.0</span>
            </div>
            <div class="nav-menu" id="nav-menu">
                <a href="#home" class="nav-link">Home</a>
                <a href="#features" class="nav-link">Features</a>
                <a href="#about" class="nav-link">About</a>
                <a href="#contact" class="nav-link">Contact</a>
            </div>
            <div class="nav-buttons">
                <button class="btn btn-primary" onclick="showLoginModal()">Get Started</button>
            </div>
            <div class="nav-toggle" id="nav-toggle">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="home" class="hero">
        <div class="hero-background">
            <div class="hero-glass"></div>
            <div class="hero-leaf" aria-hidden="true"></div>
            <div class="hero-bubbles" aria-hidden="true">
                <span class="bubble" style="--x:10%; --d:18s; --s:1;"></span>
                <span class="bubble" style="--x:25%; --d:22s; --s:1.2;"></span>
                <span class="bubble" style="--x:40%; --d:16s; --s:0.9;"></span>
                <span class="bubble" style="--x:55%; --d:20s; --s:1.1;"></span>
                <span class="bubble" style="--x:70%; --d:24s; --s:1.3;"></span>
                <span class="bubble" style="--x:85%; --d:19s; --s:0.8;"></span>
            </div>
        </div>
        <div class="hero-content">
            <div class="hero-text">
                <h1 class="hero-title">
                    <span class="title-line">Welcome to</span>
                    <span class="title-line">Smart Garbage</span>
                    <span class="title-highlight">Management</span>
                </h1>
                <p class="hero-description">
                    Join thousands of users, volunteers, and teams working together to create a cleaner, 
                    more sustainable world through our innovative platform.
                </p>
                <div class="hero-buttons">
                    <button class="btn btn-primary btn-large" onclick="showRegisterModal()">
                        <i class="fas fa-rocket"></i>
                        Join Our Community
                    </button>
                    <button class="btn btn-outline btn-large" onclick="scrollToSection('dashboard')">
                        <i class="fas fa-chart-line"></i>
                        View Live Dashboard
                    </button>
                </div>
            </div>
            <div class="hero-visual">
                <div class="welcome-card">
                    <div class="welcome-icon">
                        <i class="fas fa-recycle"></i>
                    </div>
                    <h3>Ready to Make a Difference?</h3>
                    <p>Choose your role and start contributing to a cleaner environment</p>
                    <div class="role-options">
                        <div class="role-card" onclick="showRegisterModal()">
                            <i class="fas fa-user"></i>
                            <h4>User</h4>
                            <p>Report garbage & earn points</p>
                        </div>
                        <div class="role-card" onclick="showRegisterModal()">
                            <i class="fas fa-users"></i>
                            <h4>Volunteer</h4>
                            <p>Join teams & help community</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Live Smart Bin System -->
    <section id="smart-bins" class="smart-bins-section">
        <div class="container">
            <div class="section-header" data-animation="fadeInUp">
                <h2 class="section-title">Live Smart Bin System</h2>
                <p class="section-description">Real-time visualization of nearby smart bins with animated fill levels and live status.</p>
            </div>

            <div class="bins-grid">
                <!-- Bin 1 -->
                <div class="bin-card" data-animation="fadeInUp" data-delay="100" data-category="Plastic" data-level="42">
                    <div class="bin-header">
                        <div class="bin-icon"><i class="fas fa-recycle"></i></div>
                        <div class="bin-meta">
                            <span class="bin-category">Plastic</span>
                            <span class="bin-status status-normal"><span class="dot"></span> Normal</span>
                        </div>
                    </div>
                    <div class="bin-body">
                        <div class="bin-container">
                            <div class="bin-fill" style="height: 42%"></div>
                            <div class="bin-percent">42% Full</div>
                        </div>
                    </div>
                </div>

                <!-- Bin 2 -->
                <div class="bin-card" data-animation="fadeInUp" data-delay="200" data-category="Organic" data-level="68">
                    <div class="bin-header">
                        <div class="bin-icon"><i class="fas fa-leaf"></i></div>
                        <div class="bin-meta">
                            <span class="bin-category">Organic</span>
                            <span class="bin-status status-warning"><span class="dot"></span> Nearly Full</span>
                        </div>
                    </div>
                    <div class="bin-body">
                        <div class="bin-container">
                            <div class="bin-fill" style="height: 68%"></div>
                            <div class="bin-percent">68% Full</div>
                        </div>
                    </div>
                </div>

                <!-- Bin 3 -->
                <div class="bin-card" data-animation="fadeInUp" data-delay="300" data-category="Metal" data-level="85">
                    <div class="bin-header">
                        <div class="bin-icon"><i class="fas fa-industry"></i></div>
                        <div class="bin-meta">
                            <span class="bin-category">Metal</span>
                            <span class="bin-status status-danger"><span class="dot"></span> Overflow</span>
                        </div>
                    </div>
                    <div class="bin-body">
                        <div class="bin-container">
                            <div class="bin-fill" style="height: 85%"></div>
                            <div class="bin-percent">85% Full</div>
                        </div>
                    </div>
                </div>

                <!-- Bin 4 -->
                <div class="bin-card" data-animation="fadeInUp" data-delay="400" data-category="Paper" data-level="23">
                    <div class="bin-header">
                        <div class="bin-icon"><i class="fas fa-scroll"></i></div>
                        <div class="bin-meta">
                            <span class="bin-category">Paper</span>
                            <span class="bin-status status-normal"><span class="dot"></span> Normal</span>
                        </div>
                    </div>
                    <div class="bin-body">
                        <div class="bin-container">
                            <div class="bin-fill" style="height: 23%"></div>
                            <div class="bin-percent">23% Full</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Live Dashboard Section -->
    <section id="dashboard" class="dashboard-section">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Live System Dashboard</h2>
                <p class="section-description">
                    Real-time monitoring of our garbage management system
                </p>
            </div>
            
            <!-- Live Statistics Cards -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h3><i class="fas fa-chart-line"></i> Live Statistics</h3>
                    <div class="live-indicator">
                        <span class="pulse-dot"></span>
                        <span>LIVE</span>
                    </div>
                </div>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-icon">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-number" data-target="1247">0</div>
                            <div class="stat-label">Reports Today</div>
                            <div class="stat-change positive">+12%</div>
                        </div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-number" data-target="89">0</div>
                            <div class="stat-label">Active Volunteers</div>
                            <div class="stat-change positive">+5%</div>
                        </div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-icon">
                            <i class="fas fa-crown"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-number" data-target="23">0</div>
                            <div class="stat-label">Guilds Active</div>
                            <div class="stat-change positive">+3%</div>
                        </div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-icon">
                            <i class="fas fa-leaf"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-number" data-target="156">0</div>
                            <div class="stat-label">CO2 Saved (kg)</div>
                            <div class="stat-change positive">+8%</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Live Charts Section -->
            <div class="charts-container">
                <!-- Real-time Line Chart -->
                <div class="chart-card">
                    <div class="chart-header">
                        <h4><i class="fas fa-chart-area"></i> Reports Over Time</h4>
                        <div class="chart-controls">
                            <button class="chart-btn active" data-period="24h">24H</button>
                            <button class="chart-btn" data-period="7d">7D</button>
                            <button class="chart-btn" data-period="30d">30D</button>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="reportsChart"></canvas>
                    </div>
                </div>

                <!-- Pie Chart for Waste Types -->
                <div class="chart-card">
                    <div class="chart-header">
                        <h4><i class="fas fa-chart-pie"></i> Waste Distribution</h4>
                    </div>
                    <div class="chart-container">
                        <canvas id="wasteChart"></canvas>
                    </div>
                </div>

                <!-- Bar Chart for Guild Performance -->
                <div class="chart-card">
                    <div class="chart-header">
                        <h4><i class="fas fa-trophy"></i> Top Performing Guilds</h4>
                    </div>
                    <div class="chart-container">
                        <canvas id="guildChart"></canvas>
                    </div>
                </div>

                <!-- Doughnut Chart for System Health -->
                <div class="chart-card">
                    <div class="chart-header">
                        <h4><i class="fas fa-heartbeat"></i> System Health</h4>
                    </div>
                    <div class="chart-container">
                        <canvas id="healthChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section id="features" class="features">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Powerful Features</h2>
                <p class="section-description">
                    Everything you need to manage waste effectively and make a real impact
                </p>
            </div>
            <div class="features-grid">
                <div class="feature-card" data-aos="fade-up" data-aos-delay="100">
                    <div class="feature-icon">
                        <i class="fas fa-user"></i>
                    </div>
                    <h3>User Portal</h3>
                    <p>Report garbage, track your impact, earn points, and connect with volunteers in your area.</p>
                    <ul class="feature-list">
                        <li>Easy garbage reporting</li>
                        <li>Points & rewards system</li>
                        <li>Volunteer zone access</li>
                        <li>Real-time tracking</li>
                    </ul>
                </div>
                <div class="feature-card" data-aos="fade-up" data-aos-delay="200">
                    <div class="feature-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <h3>Volunteer Portal</h3>
                    <p>Join or create guilds, take on challenges, and work together to clean up your community.</p>
                    <ul class="feature-list">
                        <li>Guild system & teamwork</li>
                        <li>Task management</li>
                        <li>Team challenges</li>
                        <li>Dual ranking system</li>
                    </ul>
                </div>
                
            </div>
        </div>
    </section>

    <!-- About Us Section -->
    <section id="about" class="about-section">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">About Our Mission</h2>
                <p class="section-description">
                    We're revolutionizing waste management through technology and community engagement
                </p>
            </div>
            <div class="about-content">
                <div class="about-text">
                    <h3>Our Vision</h3>
                    <p>To create a sustainable future where waste is managed efficiently through community collaboration and smart technology. We believe that every individual can make a difference in creating a cleaner, greener world.</p>
                    
                    <h3>What We Do</h3>
                    <p>Our platform connects users, volunteers, and administrators in a comprehensive ecosystem that makes waste management simple, rewarding, and effective. Through gamification and real-time tracking, we motivate communities to work together.</p>
                    
                    <div class="stats-row">
                        <div class="stat-box">
                            <div class="stat-number">10,000+</div>
                            <div class="stat-label">Active Users</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-number">500+</div>
                            <div class="stat-label">Volunteer Teams</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-number">50+</div>
                            <div class="stat-label">Cities Covered</div>
                        </div>
                    </div>
                </div>
                <div class="about-image">
                    <div class="image-placeholder">
                        <i class="fas fa-leaf"></i>
                        <h4>Building a Sustainable Future</h4>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contact" class="contact-section">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Get In Touch</h2>
                <p class="section-description">
                    Have questions? We'd love to hear from you. Send us a message and we'll respond as soon as possible.
                </p>
            </div>
            <div class="contact-content">
                <div class="contact-info">
                    <div class="contact-item">
                        <div class="contact-icon">
                            <i class="fas fa-map-marker-alt"></i>
                        </div>
                        <div class="contact-details">
                            <h4>Address</h4>
                            <p>123 Green Street<br>Eco City, EC 12345</p>
                        </div>
                    </div>
                    <div class="contact-item">
                        <div class="contact-icon">
                            <i class="fas fa-phone"></i>
                        </div>
                        <div class="contact-details">
                            <h4>Phone</h4>
                            <p>+1 (555) 123-4567</p>
                        </div>
                    </div>
                    <div class="contact-item">
                        <div class="contact-icon">
                            <i class="fas fa-envelope"></i>
                        </div>
                        <div class="contact-details">
                            <h4>Email</h4>
                            <p>info@smartgarbage.com</p>
                        </div>
                    </div>
                </div>
                <div class="contact-form">
                    <form id="contactForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="contactName">Full Name</label>
                                <input type="text" id="contactName" required>
                            </div>
                            <div class="form-group">
                                <label for="contactEmail">Email</label>
                                <input type="email" id="contactEmail" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="contactSubject">Subject</label>
                            <input type="text" id="contactSubject" required>
                        </div>
                        <div class="form-group">
                            <label for="contactMessage">Message</label>
                            <textarea id="contactMessage" rows="5" required></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary btn-full">Send Message</button>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Welcome Back!</h2>
                <button class="modal-close" onclick="hideLoginModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="loginForm" class="auth-form">
                    <div class="form-group">
                        <label for="loginEmail">Email</label>
                        <input type="email" id="loginEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">Password</label>
                        <input type="password" id="loginPassword" required>
                    </div>
                    <div class="form-group">
                        <label for="userType">Login As</label>
                        <select id="userType" required>
                            <option value="">Select Type</option>
                            <option value="user">User</option>
                            <option value="volunteer">Volunteer</option>
                            <option value="admin">Admin</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-primary btn-full">Login</button>
                </form>
                <div class="auth-switch">
                    <p>Don't have an account? <a href="#" onclick="showRegisterModal()">Register here</a></p>
                    <p style="margin-top: 0.5rem; font-size: 0.875rem; color: var(--gray-600);">Note: Admin login uses predefined credentials</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Register Modal -->
    <div id="registerModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Join Our Community!</h2>
                <button class="modal-close" onclick="hideRegisterModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="registerForm" class="auth-form">
                    <div class="form-group">
                        <label for="regName">Full Name</label>
                        <input type="text" id="regName" required>
                    </div>
                    <div class="form-group">
                        <label for="regEmail">Email</label>
                        <input type="email" id="regEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="regPassword">Password</label>
                        <input type="password" id="regPassword" required>
                    </div>
                    <div class="form-group">
                        <label for="regType">Account Type</label>
                        <select id="regType" required>
                            <option value="">Select Type</option>
                            <option value="user">User - Report garbage & earn points</option>
                            <option value="volunteer">Volunteer - Join teams & help community</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-primary btn-full">Create Account</button>
                </form>
                <div class="auth-switch">
                    <p>Already have an account? <a href="#" onclick="showLoginModal()">Login here</a></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Report Modal -->
    <div id="reportModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-plus"></i> Submit Garbage Report</h2>
                <button class="modal-close" onclick="hideReportModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="reportForm" class="auth-form">
                    <div class="form-group">
                        <label for="reportType">Garbage Type</label>
                        <select id="reportType" required>
                            <option value="">Select Type</option>
                            <option value="plastic">Plastic (10 points)</option>
                            <option value="paper">Paper (8 points)</option>
                            <option value="glass">Glass (12 points)</option>
                            <option value="metal">Metal (15 points)</option>
                            <option value="organic">Organic (5 points)</option>
                            <option value="hazardous">Hazardous (25 points)</option>
                            <option value="other">Other (7 points)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="reportLocation">Location</label>
                        <input type="text" id="reportLocation" placeholder="Enter location or address" required>
                    </div>
                    <div class="form-group">
                        <label for="reportDescription">Description</label>
                        <textarea id="reportDescription" rows="3" placeholder="Describe the garbage situation..." required></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary btn-full">
                        <i class="fas fa-paper-plane"></i>
                        Submit Report
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script>

        // Simple modal functions
        function showLoginModal() {
            document.getElementById('loginModal').style.display = 'flex';
        }

        function hideLoginModal() {
            document.getElementById('loginModal').style.display = 'none';
        }

        function showRegisterModal() {
            document.getElementById('registerModal').style.display = 'flex';
        }

        function hideRegisterModal() {
            document.getElementById('registerModal').style.display = 'none';
        }

        function scrollToSection(sectionId) {
            document.getElementById(sectionId).scrollIntoView({ behavior: 'smooth' });
        }

        // Animate counters
        function animateCounters() {
            const counters = document.querySelectorAll('.stat-number');
            counters.forEach(counter => {
                const target = parseInt(counter.getAttribute('data-target'));
                let current = 0;
                const increment = target / 100;
                const timer = setInterval(() => {
                    current += increment;
                    counter.textContent = Math.floor(current);
                    if (current >= target) {
                        counter.textContent = target;
                        clearInterval(timer);
                    }
                }, 20);
            });
        }

        // Initialize Charts
        let reportsChart; // Make it accessible globally for updateReportsChart
        
        function initializeCharts() {
            // Check if Chart.js is loaded
            if (typeof Chart === 'undefined') {
                console.error('Chart.js is not loaded');
                return;
            }
            
            // Reports Over Time Chart (Line Chart)
            const reportsCanvas = document.getElementById('reportsChart');
            if (!reportsCanvas) {
                console.error('Reports chart canvas not found');
            } else {
                const reportsCtx = reportsCanvas.getContext('2d');
                reportsChart = new Chart(reportsCtx, {
                    type: 'line',
                    data: {
                        labels: ['00:00', '04:00', '08:00', '12:00', '16:00', '20:00', '24:00'],
                    datasets: [{
                        label: 'Reports',
                        data: [45, 32, 67, 89, 123, 156, 189],
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: '#10b981',
                        pointBorderColor: '#ffffff',
                        pointBorderWidth: 2,
                        pointRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0,0,0,0.1)'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    },
                    animation: {
                        duration: 2000,
                        easing: 'easeInOutQuart'
                    }
                }
            });
            }

            // Waste Distribution Chart (Pie Chart) - Load real data
            const wasteCanvas = document.getElementById('wasteChart');
            if (!wasteCanvas) {
                console.error('Waste chart canvas not found');
            } else {
                // Fetch real data from API
                fetch('http://localhost:8080/api/reports/stats')
                    .then(response => response.json())
                    .then(data => {
                        if (data.status === 'success' && data.data) {
                            const stats = JSON.parse(data.data);
                            const total = stats.total || 0;
                            
                            // Calculate percentages if we have data
                            let chartData = [0, 0, 0, 0, 0, 0, 0];
                            if (total > 0) {
                                chartData = [
                                    stats.plastic || 0,
                                    stats.paper || 0,
                                    stats.glass || 0,
                                    stats.metal || 0,
                                    stats.organic || 0,
                                    stats.hazardous || 0,
                                    stats.other || 0
                                ];
                            } else {
                                // Use default demo data if no reports
                                chartData = [35, 25, 15, 12, 8, 0, 5];
                            }
                            
                            const wasteCtx = wasteCanvas.getContext('2d');
                            const wasteChart = new Chart(wasteCtx, {
                                type: 'pie',
                                data: {
                                    labels: ['Plastic', 'Paper', 'Glass', 'Metal', 'Organic', 'Hazardous', 'Other'],
                                    datasets: [{
                                        data: chartData,
                                        backgroundColor: [
                                            '#10b981',
                                            '#3b82f6',
                                            '#f59e0b',
                                            '#ef4444',
                                            '#8b5cf6',
                                            '#dc2626',
                                            '#6b7280'
                                        ],
                                        borderWidth: 0,
                                        hoverOffset: 10
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: false,
                                    plugins: {
                                        legend: {
                                            position: 'bottom',
                                            labels: {
                                                padding: 20,
                                                usePointStyle: true
                                            }
                                        }
                                    },
                                    animation: {
                                        animateRotate: true,
                                        duration: 2000
                                    }
                                }
                            });
                        } else {
                            // Fallback to default data
                            const wasteCtx = wasteCanvas.getContext('2d');
                            const wasteChart = new Chart(wasteCtx, {
                                type: 'pie',
                                data: {
                                    labels: ['Plastic', 'Paper', 'Glass', 'Metal', 'Organic', 'Hazardous', 'Other'],
                                    datasets: [{
                                        data: [35, 25, 15, 12, 8, 0, 5],
                                        backgroundColor: [
                                            '#10b981',
                                            '#3b82f6',
                                            '#f59e0b',
                                            '#ef4444',
                                            '#8b5cf6',
                                            '#dc2626',
                                            '#6b7280'
                                        ],
                                        borderWidth: 0,
                                        hoverOffset: 10
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: false,
                                    plugins: {
                                        legend: {
                                            position: 'bottom',
                                            labels: {
                                                padding: 20,
                                                usePointStyle: true
                                            }
                                        }
                                    },
                                    animation: {
                                        animateRotate: true,
                                        duration: 2000
                                    }
                                }
                            });
                        }
                    })
                    .catch(error => {
                        console.error('Error loading chart data:', error);
                        // Fallback to default
                        const wasteCtx = wasteCanvas.getContext('2d');
                        const wasteChart = new Chart(wasteCtx, {
                            type: 'pie',
                            data: {
                                labels: ['Plastic', 'Paper', 'Glass', 'Metal', 'Organic', 'Hazardous', 'Other'],
                                datasets: [{
                                    data: [35, 25, 15, 12, 8, 0, 5],
                                    backgroundColor: [
                                        '#10b981',
                                        '#3b82f6',
                                        '#f59e0b',
                                        '#ef4444',
                                        '#8b5cf6',
                                        '#dc2626',
                                        '#6b7280'
                                    ],
                                    borderWidth: 0,
                                    hoverOffset: 10
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    legend: {
                                        position: 'bottom',
                                        labels: {
                                            padding: 20,
                                            usePointStyle: true
                                        }
                                    }
                                },
                                animation: {
                                    animateRotate: true,
                                    duration: 2000
                                }
                            }
                        });
                    });
            }

            // Guild Performance Chart (Bar Chart)
            const guildCanvas = document.getElementById('guildChart');
            if (!guildCanvas) {
                console.error('Guild chart canvas not found');
            } else {
                const guildCtx = guildCanvas.getContext('2d');
                const guildChart = new Chart(guildCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Eco Warriors', 'Green Guardians', 'Clean Crew', 'Earth Savers', 'Waste Busters'],
                    datasets: [{
                        label: 'Points',
                        data: [1250, 980, 875, 720, 650],
                        backgroundColor: [
                            '#10b981',
                            '#3b82f6',
                            '#f59e0b',
                            '#ef4444',
                            '#8b5cf6'
                        ],
                        borderRadius: 8,
                        borderSkipped: false
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0,0,0,0.1)'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    },
                    animation: {
                        duration: 2000,
                        easing: 'easeOutBounce'
                    }
                }
            });
            }

            // System Health Chart (Doughnut Chart)
            const healthCanvas = document.getElementById('healthChart');
            if (!healthCanvas) {
                console.error('Health chart canvas not found');
            } else {
                const healthCtx = healthCanvas.getContext('2d');
                const healthChart = new Chart(healthCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Active', 'Maintenance', 'Offline'],
                    datasets: [{
                        data: [85, 12, 3],
                        backgroundColor: [
                            '#10b981',
                            '#f59e0b',
                            '#ef4444'
                        ],
                        borderWidth: 0,
                        cutout: '70%'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                usePointStyle: true
                            }
                        }
                    },
                    animation: {
                        animateRotate: true,
                        duration: 2000
                    }
                }
            });

                // Chart period controls
                document.querySelectorAll('.chart-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        document.querySelectorAll('.chart-btn').forEach(b => b.classList.remove('active'));
                        this.classList.add('active');
                        
                        // Update chart data based on period
                        const period = this.dataset.period;
                        if (typeof reportsChart !== 'undefined' && reportsChart) {
                            updateReportsChart(reportsChart, period);
                        }
                    });
                });
            }
        }

        // Update reports chart based on selected period
        function updateReportsChart(chart, period) {
            let newData, newLabels;
            
            switch(period) {
                case '24h':
                    newLabels = ['00:00', '04:00', '08:00', '12:00', '16:00', '20:00', '24:00'];
                    newData = [45, 32, 67, 89, 123, 156, 189];
                    break;
                case '7d':
                    newLabels = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];
                    newData = [234, 189, 267, 345, 298, 156, 89];
                    break;
                case '30d':
                    newLabels = ['Week 1', 'Week 2', 'Week 3', 'Week 4'];
                    newData = [1234, 1456, 1678, 1890];
                    break;
            }
            
            chart.data.labels = newLabels;
            chart.data.datasets[0].data = newData;
            chart.update('active');
        }

        // Wait for DOM and Chart.js to be ready
        document.addEventListener('DOMContentLoaded', function() {
            // Start counter animation when page loads
            setTimeout(animateCounters, 1000);
            
            // Initialize charts after a short delay
            setTimeout(initializeCharts, 1500);
        });

        // Close modals when clicking outside
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('modal')) {
                e.target.style.display = 'none';
            }
        });

        // Contact form submission
        document.addEventListener('DOMContentLoaded', function() {
            const contactForm = document.getElementById('contactForm');
            if (contactForm) {
                contactForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    // Use SmartGarbage.showNotification if available, otherwise use local function
                    const notify = (window.SmartGarbage && window.SmartGarbage.showNotification) 
                        ? window.SmartGarbage.showNotification 
                        : showNotification;
                    notify('Thank you for your message! We\'ll get back to you soon.', 'success');
                    this.reset();
                });
            }
        });
    </script>
</body>
</html>
